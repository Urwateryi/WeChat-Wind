<!-- 引入wxs -->
<wxs src="../../util/filter.wxs" module='filter' />

<view class='container'>
  <view class='head'>
    <image src='{{book.image}}' />
    <text class='title'>{{book.title}}</text>
    <text class='author'>{{book.author}}</text>
  </view>

  <view class='sub-container'>
    <text class='headline'>短评</text>
    <view class='comment-container'>
      <block wx:for="{{comments}}" wx:key="index">
        <z-tag tag-class="{{index==0?'ex-tag1':''||index==1?'ex-tag2':''}}" text="{{item.content}}">
          <text class='num' slot="after">{{' +'+item.nums}}</text>
        </z-tag>
      </block>
    </view>
  </view>

  <view class='sub-container'>
    <text class='headline'>内容简介</text>
    <text class='content' decode='{{true}}'>{{filter.format(book.summary)}}</text>
  </view>
</view>

<!-- wxs也可以直接在wxml中定义
<wxs module="filter">
  var limit = function(array, length) {
    return array.slice(0, length)
  }
  var format = function(text){
    if(!text){
      return
    }
    var reg = getRegExp('\\\\n','g')
    var text = text.replace(reg,'\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
    return text
  }
  module.exports = {
    limit: limit,
    format:format
  }
</wxs> -->